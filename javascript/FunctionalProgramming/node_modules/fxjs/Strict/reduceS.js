"use strict";

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.promise");

var go2 = require("../.internal/go2.js");

var go1 = require("./go1.js");

var toIter = require("./toIter.js");

var head = require("./head.js");

var isStop = require("./isStop.js");

module.exports = reduceS;

function reduceS(f, acc, iter) {
  if (arguments.length == 1) return (..._) => reduceS(f, ..._);
  if (arguments.length == 2) return reduceS(f, head(iter = toIter(acc)), iter);
  iter = toIter(iter);
  return go1(acc, function recur(acc) {
    let cur;

    while (!isStop(acc) && !(cur = iter.next()).done) {
      acc = go2(acc, cur.value, f);
      if (acc instanceof Promise) return acc.then(recur);
    }

    return isStop(acc) ? acc.value : acc;
  });
}